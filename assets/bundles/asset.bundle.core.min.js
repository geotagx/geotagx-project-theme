!function(a,b,c){"use strict";function d(){a.project.locale.initialize()}function e(){a.project.questionnaire.initialize()}function f(){a.project.subject.initialize()}function g(){var a=200,c=1289;setTimeout(function(){l(a,c),b("#project-analyses-completed").fadeIn(300)},500)}function h(){a.project.questionnaire.on(a.project.questionnaire.EVENT_SUBMIT,m),a.project.locale.on(a.project.locale.EVENT_LOCALE_CHANGED,n)}function i(a){a=b.trim(a),a.length>0&&(document.querySelector("#project-name > .value").innerHTML=a)}function j(c){var d=document.getElementById("project-description");d&&(c=b.trim(a.project.locale.inCurrentLocale(c)),d.innerHTML=c,d.style.display=c.length>0?"block":"none")}function k(a,b){}function l(a,b){document.querySelector("#project-analyses-completed > .count > .completed").innerHTML=a,b&&(document.querySelector("#project-analyses-completed > .count > .total").innerHTML=b)}function m(b,c,d,e){setTimeout(function(){d(),setTimeout(function(){a.project.questionnaire.start()},1500)},1e3)}function n(){j(__configuration__.project.description)}a.project=a.project||{},a.project.EVENT_READY="project-ready",b(document).ready(function(){a.project=Object.freeze(a.project),a.project.on(a.project.EVENT_READY,a.project.questionnaire.start),a.project.initialize()}),a.project.initialize=function(){d(),i(__configuration__.project.name),j(__configuration__.project.description),k(__configuration__.project.repository.url,__configuration__.project.repository.type),g(),e(),f(),h(),a.project.trigger(a.project.EVENT_READY)},a.project.on=function(a,c){b("#project").on(a,c)},a.project.off=function(a,c){b("#project").off(a,c)},a.project.trigger=function(a,c){b("#project").trigger(a,c)}}(window.geotagx=window.geotagx||{},jQuery),function(a,b,c){"use strict";function d(a,c){b(g).trigger(a,c)}var e={},f=null,g=null;e.EVENT_LOCALE_CHANGED="locale-changed",e.initialize=function(){var a=__configuration__.project.locale;f=a["default"],g=document.getElementById("project-locale-selector");var c=Object.keys(a.available);if(c.length>1){b(g).change(function(a){f=a.currentTarget.value,d(e.EVENT_LOCALE_CHANGED,f)});for(var h=0;h<c.length;++h){var i=c[h],j=e.getName(i),k=document.createElement("option");k&&(k.text=j,k.value=i,g.add(k))}g.value=f,document.getElementById("project-locale").style.display="inline"}},e.on=function(a,c){b(g).on(a,c)},e.off=function(a,c){b(g).off(a,c)},e.getCurrentLocale=function(){return f},e.isAvailable=function(a){return a in __configuration__.project.locale.available},e.getName=function(a){return e.isAvailable(a)?__configuration__.project.locale.available[a]:null},e.inCurrentLocale=function(a){var b=typeof a;return"string"===b?a:"object"===b&&f in a?a[f]:null},a.locale=Object.freeze(e)}(window.geotagx.project,jQuery),function(a,b,c){"use strict";function d(a){if(a){var c=a.key,d=a.type;b("#question").attr("data-key",c).attr("data-type",d);var i="hint"in a,j="help"in a;b("#question-assistance").toggleClass("hide",!i&&!j),b("#question-hint").toggleClass("hide",!i),b("#question-more-help").toggleClass("hide",!j);var k=s[c];w.push(k);var l=Math.max(0,Math.min(100,(k/t.length*100).toFixed(0))),m=y.offsetWidth-A.offsetWidth-100;B.css("width",Math.round(l*m/100)+"px"),C.innerHTML=l+"%",A.disabled=w.length<2;var n=a.parameters;switch(d){case"dropdown-list":e(c,n);break;case"select":f(c,n);break;case"checklist":g(c,n);break;case"illustrative-checklist":buildIllustrativeChecklistField(c,n);break;case"geolocation":buildGeolocationField(c,n)}h(a),q(r.EVENT_QUESTION_CHANGED)}}function e(a,b){var c=document.getElementById("dropdown-list-field"),d="dropdown-list-field-for-"+a,e=sessionStorage.getItem(d);if(null===e){e='<option name="'+a+'" role="prompt" selected disabled></option>';for(var f=0;f<b.options.length;++f){var g=b.options[f];e+='<option name="'+a+'" value="'+g.value+'"></option>'}sessionStorage.setItem(d,e)}c.innerHTML=e}function f(a,b){var c="select-field-for-"+a,d=sessionStorage.getItem(c);if(null===d){d="";for(var e=0;e<b.options.length;++e){var f=b.options[e];d+='<label><input type="radio" name="'+a+'" value="'+f.value+'"><span role="label-name"></span></label><br>'}sessionStorage.setItem(c,d)}document.querySelector("#select-field > section.custom-labels").innerHTML=d,document.querySelector('#select-field > label[role="other-option"] > input[type="radio"]').setAttribute("name",a)}function g(a,b){var c="checklist-field-for-"+a,d=sessionStorage.getItem(c);if(null===d){d="";for(var e=0;e<b.options.length;++e){var f=b.options[e];d+='<label><input type="checkbox" name="'+a+'" value="'+f.value+'"><span role="label-name"></span></label><br>'}sessionStorage.setItem(c,d)}document.querySelector("#checklist-field > section.custom-labels").innerHTML=d,document.querySelector('#checklist-field > label[role="other-option"] > input[type="checkbox"]').setAttribute("name",a)}function h(a){var c=geotagx.project.locale.inCurrentLocale(a.title);b("#question-title").html(c);var d=a.hint?geotagx.project.locale.inCurrentLocale(a.hint):null;null!==d&&(document.getElementById("question-hint").innerHTML=d);var e=a.help?geotagx.project.locale.inCurrentLocale(a.help):null;switch(null!==e&&(document.getElementById("question-help-modal-title").innerHTML=c,document.getElementById("question-help-modal-content").innerHTML=e),a.type){case"dropdown-list":return void i(a.key,a.parameters);case"select":case"checklist":return void j(a.type,a.key,a.parameters);default:return}}function i(a,b){var c="Please select an item",d=b.options,e=document.getElementById("dropdown-list-field").children;e[0].innerHTML=c;for(var f=0;f<d.length;++f)e[f+1].innerHTML=geotagx.project.locale.inCurrentLocale(d[f].label)}function j(a,b,c){for(var d=0;d<c.options.length;++d){var e=c.options[d],f="#"+a+'-field > section.custom-labels > label > input[value="'+e.value+'"] + span[role="label-name"]';document.querySelector(f).innerHTML=geotagx.project.locale.inCurrentLocale(e.label)}}function k(a){var c=r.getCurrentQuestion(),d=c.type,e=a.currentTarget.value;if("OK"===e)switch(d){case"url":case"text":case"longtext":e=b.trim(document.getElementById(d+"-field").value),e=e.length>0?e:null;break;case"number":e=parseFloat(b.trim(document.getElementById("number-field").value)),e=!isNaN(e)&&isFinite(e)?e:null;break;case"dropdown-list":var f=document.querySelector("#dropdown-list-field > option:checked:not(:disabled)");e=null!==f?b.trim(f.value):"None";break;case"select":case"checklist":e="";var g=document.querySelectorAll("#"+d+'-field input[name="'+c.key+'"]:checked');if(g&&g.length>0){for(var h=0;h<g.length;++h){var i=g[h],j=b.trim(i.value);if(j.length>0&&(e+=", "+j,"Other"===j)){var k=b.trim(b(i).siblings('input[type="text"]').val());k.length>0&&(e+="["+k+"]")}}e=e.substring(2)}e=e.length>0?e:"None"}var l=p(e,d);null===l&&(u[c.key]=e,q(r.EVENT_QUESTION_ANSWERED,[c.key,e]))}function l(a){D.error.style.display="none",b(D.busy).fadeIn(150,function(){D.busy.style.display="inline-block"}),a.currentTarget.disabled=!0,q(r.EVENT_SUBMIT,[u,m,n])}function m(){b(D.busy).fadeOut(150,function(){D.busy.style.display="none",b(D.success).fadeIn(150)})}function n(a){b(D.busy).fadeOut(150,function(){D.busy.style.display="none",b(D.error).fadeIn(150,function(){a=b.trim(a),a.length>0&&(F.innerHTML=a,F.dataset.severity="error",b(F).fadeIn(300)),E.disabled=!1})})}function o(){h(r.getCurrentQuestion())}function p(a,b){return null}function q(a,c){b(x).trigger(a,c)}var r={},s=null,t=null,u=null,v=null,w=null,x=null,y=null,z=null,A=null,B=null,C=null,D=null,E=null,F=null;r.EVENT_START="questionnaire-start",r.EVENT_FINISH="questionnaire-finish",r.EVENT_REWIND="questionnaire-rewind",r.EVENT_SUBMIT="questionnaire-submit",r.EVENT_QUESTION_CHANGED="question-changed",r.EVENT_QUESTION_ANSWERED="question-answered",r.initialize=function(){var a=__configuration__.taskPresenter;s=a.questionnaire.index,t=a.questionnaire.questions,v=t[0],x=document.getElementById("questionnaire"),y=document.getElementById("questionnaire-progress"),z=b("#question-answer-buttons > .btn"),A=document.getElementById("questionnaire-rewind"),B=b("#questionnaire-progress-bar"),C=document.getElementById("questionnaire-percentage-complete"),D={busy:document.getElementById("questionnaire-status-busy"),success:document.getElementById("questionnaire-status-success"),error:document.getElementById("questionnaire-status-error")},E=document.getElementById("questionnaire-submission-button"),F=document.getElementById("questionnaire-submission-message"),u={};for(var c=0;c<t.length;++c){var d=t[c].key;u[d]=null}b(A).click(function(){r.showPreviousQuestion()}),z.click(k),b(x).on(r.EVENT_QUESTION_ANSWERED,function(a,b,c){r.showNextQuestion(c)}),b("#dropdown-list-field").change(function(){document.getElementById("dropdown-list-field-reset").disabled=!1}),b("#dropdown-list-field-reset").click(function(){document.getElementById("dropdown-list-field").selectedIndex=0,this.disabled=!0}),b(E).click(l),geotagx.project.locale.on(geotagx.project.locale.EVENT_LOCALE_CHANGED,o)},r.start=function(a){w=[];for(var b in u)u.hasOwnProperty(b)&&(u[b]=null);x.dataset.finished="false";for(var c in D)D.hasOwnProperty(c)&&(D[c].style.display="none");F.display="none",a&&r.keyExists(a)&&(v=r.getQuestion(a)),d(v),q(r.EVENT_START)},r.finish=function(){B.css("width",y.offsetWidth-A.offsetWidth+"px"),C.innerHTML="100%",x.dataset.finished="true",E.disabled=!1,q(r.EVENT_FINISH)},r.getLength=function(){return t.length},r.getAnswer=function(a){return a in u?u[a]:null},r.getAnswers=function(){return u},r.keyExists=function(a){return a&&"string"==typeof a&&a in s},r.getQuestion=function(a){return r.keyExists(a)?t[s[a]]:null},r.getCurrentQuestion=function(){var a=w.length>0?w[w.length-1]:null;return null!==a?t[a]:null},r.getPreviousQuestion=function(){var a=w.length>1?w[w.length-2]:null;return null!==a?t[a]:null},r.getNextQuestion=function(a,d){d=d||r.getCurrentQuestion();var e=-1,f=d.branch||null;if(null!==f){var g=0,h=1,i="object"==typeof f?h:"string"==typeof f?g:c;if(i===g)e=s[f];else if(i===h&&null!==a&&(a=b.trim(a).toLowerCase(),"binary"!==d.type||a in f||"yes"===a||(a="no"),a in f)){var j=f[a];e=s[j]}}return-1===e&&(e=s[d.key]+1),e<t.length?t[e]:null},r.showQuestion=function(a){var b=r.getQuestion(a);null!==b&&d(b)},r.showPreviousQuestion=function(){if(w.length>1){"true"===x.dataset.finished?x.dataset.finished="false":(u[r.getCurrentQuestion().key]=null,w.pop());var a=r.getCurrentQuestion();w.pop(),d(a),q(r.EVENT_REWIND)}},r.showNextQuestion=function(a){var b=r.getNextQuestion(a);null!==b?d(b):r.finish()},r.on=function(a,c){b(x).on(a,c)},r.off=function(a,c){b(x).off(a,c)},a.questionnaire=Object.freeze(r)}(window.geotagx.project,jQuery),function(a,b,c){"use strict";function d(){f instanceof geotagx.Image&&(b("#project-subject-zoom-in").click(function(){f.zoomIn(),e.trigger(e.EVENT_IMAGE_ZOOM,1)}),b("#project-subject-zoom-out").click(function(){f.zoomOut(),e.trigger(e.EVENT_IMAGE_ZOOM,-1)}),b("#project-subject-zoom-reset").click(function(){f.zoomReset(),e.trigger(e.EVENT_IMAGE_ZOOM,0)}),b("#project-subject-rotate-left").click(function(){f.rotateLeft(),e.trigger(e.EVENT_IMAGE_ROTATE,f.image.rotation)}),b("#project-subject-rotate-right").click(function(){f.rotateRight(),e.trigger(e.EVENT_IMAGE_ROTATE,f.image.rotation)}))}var e={},f=null;e.EVENT_URL_CHANGE="project-subject-url-change",e.EVENT_SOURCE_CHANGE="project-subject-source-change",e.EVENT_IMAGE_ROTATE="project-subject-image-rotate",e.EVENT_IMAGE_ZOOM="project-subject-image-zoom",e.TYPE_IMAGE="image",e.TYPE_PDF="pdf",e.initialize=function(){var a=b.trim(__configuration__.taskPresenter.subject.type),c=document.getElementById("project-subject");c&&(c.dataset.type=a);var g=geotagx.Image;switch(a){case e.TYPE_PDF:g=geotagx.PDF;break;case e.TYPE_IMAGE:}f=new g("project-subject-body"),d()},e.on=function(a,c){b("#project-subject").on(a,c)},e.off=function(a,c){b("#project-subject").off(a,c)},e.trigger=function(a,c){b("#project-subject").trigger(a,c)},e.getType=function(){return f instanceof geotagx.Image?e.TYPE_IMAGE:f instanceof geotagx.PDF?e.TYPE_PDF:null},e.getUrl=function(){return f.getSource()},e.setUrl=function(a){a=b.trim(a),a.length>0&&f&&f.setSource&&"function"==typeof f.setSource&&(f.setSource(a),e.trigger(e.EVENT_URL_CHANGE,a))},e.getSource=function(){return document.getElementById("project-subject-source").href},e.setSource=function(a){a=b.trim(a),a.length>0&&(document.getElementById("project-subject-source").href=a,e.trigger(e.EVENT_SOURCE_CHANGE,a))},a.subject=Object.freeze(e)}(window.geotagx.project,jQuery),function(a,b,c){"use strict";function d(a,b){var c=window.getComputedStyle(a,null);b.w=parseInt(c.width,10),b.h=parseInt(c.height,10),b.bgw=b.w,b.bgh=b.h,b.x=0,b.y=0,a.style.width="100%",a.style.height="100%",a.style.backgroundImage='url("'+a.src+'")',a.style.backgroundRepeat="no-repeat",a.style.backgroundSize="100% 100%",a.style.backgroundPosition="0 0",a.src=e(a.naturalWidth,a.naturalHeight)}function e(a,b){var c=document.createElement("canvas");return c.width=a,c.height=b,c.toDataURL()}function f(a,b){b.x>0?b.x=0:b.x<b.w-b.bgw&&(b.x=b.w-b.bgw),b.y>0?b.y=0:b.y<b.h-b.bgh&&(b.y=b.h-b.bgh),a.style.backgroundSize=b.bgw+"px "+b.bgh+"px",a.style.backgroundPosition=b.x+"px "+b.y+"px"}function g(a,c,d,e,g){var h=a.attributes,i=e-h.x,j=g-h.y,k=i/h.bgw,l=j/h.bgh;0>c?(h.bgw+=h.bgw*d,h.bgh+=h.bgh*d):(h.bgw-=h.bgw*d,h.bgh-=h.bgh*d),h.x=e-h.bgw*k,h.y=g-h.bgh*l,h.bgw<=h.w||h.bgh<=h.h?(h.x=0,h.y=0,h.bgw=h.w,h.bgh=h.h):b(a.image).trigger("zoom",0>c?-1:1),f(a.image,h)}function h(a){a.preventDefault();var b=a.deltaY?a.deltaY:a.wheelDelta?-a.wheelDelta:0,c=this.image.getBoundingClientRect(),d=a.pageX-c.left-document.body.scrollLeft,e=a.pageY-c.top-document.body.scrollTop;switch(this.image.rotation){case 90:var f=d;d=e/c.height*c.width,e=c.height-f/c.width*c.height;break;case 180:d=c.width-d,e=c.height-e;break;case 270:var f=d;d=c.width-e/c.height*c.width,e=f/c.width*c.height}g(this,b,this.settings.zoomFactor,d,e)}function i(a){function b(a){var b=a.pageX-e.e.pageX,c=a.pageY-e.e.pageY;switch(e.e=a,a.preventDefault(),d.rotation){case 90:e.x+=c,e.y-=b;break;case 180:e.x-=b,e.y-=c;break;case 270:e.x-=c,e.y+=b;break;default:e.x+=b,e.y+=c}f(d,e)}function c(){document.removeEventListener("mouseup",c),document.removeEventListener("mousemove",b)}a.preventDefault();var d=this.image,e=this.attributes;e.e=a,document.addEventListener("mousemove",b),document.addEventListener("mouseup",c)}function j(a,b){b=(360+b)%360;var c=a.frame,d=a.image,e=90===b||270===b?1/d.aspectRatio:d.aspectRatio,f=c.offsetWidth,g=f/e;c.style.height=g+"px",f=c.offsetWidth;var h=1,i=1;e!==d.aspectRatio&&(h=g/f,i=f/g),d.rotation=b,d.style.transform=d.style.oTransform=d.style.msTransform=d.style.mozTransform=d.style.webkitTransform="rotate("+d.rotation+"deg) scale("+h+", "+i+")";var j=window.getComputedStyle(d,null);a.attributes.w=parseInt(j.width,10),a.attributes.h=parseInt(j.height,10),k.prototype.zoomReset.call(a)}var k=function(a,c){this.frame=document.getElementById(a),this.frame.style.overflow="hidden",this.frame.style.backgroundColor="rgba(0, 0, 0, 0.25)",this.busyIcon=this.frame.appendChild(document.createElement("i")),this.busyIcon.className="fa fa-3x fa-cog fa-spin",this.busyIcon.style.color="#FFF",this.busyIcon.style.position="absolute",this.busyIcon.style.display="none",this.image=this.frame.appendChild(document.createElement("img")),this.image.addEventListener("wheel",h.bind(this)),this.image.addEventListener("mousedown",i.bind(this)),this.image.aspectRatio=0,this.image.rotation=0,this.settings=b.extend({zoomFactor:.15,discreetZoomFactor:.45},c),this.attributes={x:0,y:0,w:0,h:0,bgw:0,bgh:0,e:null}};k.prototype.getSource=function(){return b(this.image).data("src")},k.prototype.setSource=function(a){if("string"===b.type(a)){var c=this;b(c.image).fadeOut(100,function(){if(b(c.image).data("src")==a)k.prototype.zoomReset.call(c),b(c.image).fadeIn();else{c.busyIcon.style.display="block",b(c.image).attr("src",a).data("src",a);var e=setInterval(function(){if(c.image.complete){clearInterval(e),c.image.aspectRatio=c.image.naturalWidth/c.image.naturalHeight;var a=c.frame.offsetWidth,f=Math.ceil(a/c.image.aspectRatio),g=.5*(a-c.busyIcon.offsetWidth),h=.5*(f-c.busyIcon.offsetHeight);c.busyIcon.style.display="none",b(c.image).fadeIn(0,function(){c.frame.style.height=f+"px",c.busyIcon.style.left=g+"px",c.busyIcon.style.top=h+"px",d(c.image,c.attributes),j(c,0)})}},300)}})}},k.prototype.zoomIn=function(){var a=this.image.width/2,b=this.image.height/2;g(this,-1,this.settings.discreetZoomFactor,a,b)},k.prototype.zoomOut=function(){var a=this.image.width/2,b=this.image.height/2;g(this,1,this.settings.discreetZoomFactor,a,b)},k.prototype.zoomReset=function(){this.attributes.x=0,this.attributes.y=0,this.attributes.bgw=this.attributes.w,this.attributes.bgh=this.attributes.h,f(this.image,this.attributes)},k.prototype.rotateLeft=function(){j(this,this.image.rotation-90)},k.prototype.rotateRight=function(){j(this,this.image.rotation+90)},a.Image=k}(window.geotagx=window.geotagx||{},jQuery),function(a,b,c){"use strict";var d=function(a,b){this.frame=document.getElementById(a),this.frame.style.overflow="hidden",this.busyIcon=this.frame.appendChild(document.createElement("i")),this.busyIcon.className="fa fa-3x fa-cog fa-spin",this.busyIcon.style.color="#FFF",this.busyIcon.style.position="absolute",this.busyIcon.style.display="none",this.pdf=this.frame.appendChild(document.createElement("iframe")),this.pdf.width="100%",this.pdf.height="600px",this.pdf.viewer_url="http://mozilla.github.io/pdf.js/web/viewer.html",this.pdf.default_zoom="page-width"};d.prototype.getSource=function(){return this.pdf.file_url},d.prototype.setSource=function(a){"string"===b.type(a)&&(this.pdf.file_url=a,this.pdf.src=this.pdf.viewer_url+"?file="+encodeURIComponent(this.pdf.file_url)+"#zoom="+this.pdf.default_zoom)},a.PDF=d}(window.geotagx=window.geotagx||{},jQuery);